<!DOCTYPE HTML>
<html>

    <head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<meta name="description" content="This is a portfolio of my data work">
	<meta name="author" content="Ruchen Shangguan">
	<meta name="generator" content="Hugo 0.74.3" />
	<title>Mask Acceptance &middot; Portfolio website for Ruchen Shangguan</title>
	<!-- Stylesheets -->
	
	<link rel="stylesheet" href="/css/main.css"/>
	
	

	

	<!-- Custom Fonts -->
	<link href="/css/font-awesome.min.css" rel="stylesheet" type="text/css">

	
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
	<link rel="icon" type="image/x-icon" href="/favicon.ico">
	

	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
	<script src="js/ie/html5shiv.js"></script>
	<script src="js/ie/html5shiv.jsrespond.min.js"></script>
	<![endif]-->
</head>

    <body>

    <!-- Wrapper -->
        <div id="wrapper">

            <!-- Header -->
    <header id="header" class="alt">
        <a href="/" class="logo"><strong>Ruchen&#39;s portfolio</strong> <span>A very first step with Git</span></a>
        <nav>
            <a href="#menu">Menu</a>
        </nav>
    </header>

<!-- Menu -->
    <nav id="menu">
        <ul class="links">
            
                <li><a href="/">Home</a></li>
            
                <li><a href="/blogs">Blogs</a></li>
            

        </ul>
        <ul class="actions vertical">
            
                <li><a href="/blogs" class="button special fit">My projects</a></li>
            
            
        </ul>
    </nav>

        <!-- Main -->
            <div id="main" class="alt">

                
                    <section id="one">
                        <div class="inner">
                            <header class="major">
                                <h1>Mask Acceptance</h1>
                            </header>
                            
                                <span class="image main"><img src="/img/blogs/pic07.jpg" alt="" /></span>
                            
                            <h2 id="nyt-mask-use">NYT mask use</h2>
<p>Github source for data <a href="https://github.com/nytimes/covid-19-data/tree/master/mask-use">https://github.com/nytimes/covid-19-data/tree/master/mask-use</a></p>
<h2 id="getting-the-data">Getting the data</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e">#Source for data </span>
url <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;https://github.com/nytimes/covid-19-data/raw/master/mask-use/mask-use-by-county.csv&#34;</span>

nyt_mask_survey <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_csv</span>(here<span style="color:#f92672">::</span><span style="color:#a6e22e">here</span>(<span style="color:#e6db74">&#34;data&#34;</span>, <span style="color:#e6db74">&#34;nyt_mask_survey.csv&#34;</span>))

nyt_mask_survey <span style="color:#f92672">&lt;-</span> nyt_mask_survey <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">clean_names</span>() <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(
    mostly_yes<span style="color:#f92672">=</span> frequently<span style="color:#f92672">+</span>always,
    mostly_no <span style="color:#f92672">=</span> never<span style="color:#f92672">+</span>rarely,
    delta <span style="color:#f92672">=</span> mostly_yes<span style="color:#f92672">-</span>mostly_no
  )

<span style="color:#a6e22e">glimpse</span>(nyt_mask_survey)
</code></pre></div><pre><code>## Rows: 3,142
## Columns: 9
## $ countyfp   &lt;chr&gt; &quot;01001&quot;, &quot;01003&quot;, &quot;01005&quot;, &quot;01007&quot;, &quot;01009&quot;, &quot;01011&quot;…
## $ never      &lt;dbl&gt; 0.053, 0.083, 0.067, 0.020, 0.053, 0.031, 0.102, 0.1…
## $ rarely     &lt;dbl&gt; 0.074, 0.059, 0.121, 0.034, 0.114, 0.040, 0.053, 0.1…
## $ sometimes  &lt;dbl&gt; 0.134, 0.098, 0.120, 0.096, 0.180, 0.144, 0.257, 0.1…
## $ frequently &lt;dbl&gt; 0.295, 0.323, 0.201, 0.278, 0.194, 0.286, 0.137, 0.1…
## $ always     &lt;dbl&gt; 0.444, 0.436, 0.491, 0.572, 0.459, 0.500, 0.451, 0.4…
## $ mostly_yes &lt;dbl&gt; 0.739, 0.759, 0.692, 0.850, 0.653, 0.786, 0.588, 0.6…
## $ mostly_no  &lt;dbl&gt; 0.127, 0.142, 0.188, 0.054, 0.167, 0.071, 0.155, 0.2…
## $ delta      &lt;dbl&gt; 0.612, 0.617, 0.504, 0.796, 0.486, 0.715, 0.433, 0.3…
</code></pre><h2 id="choropleth-map">Choropleth map</h2>
<p>The FIPS code is a federal code that numbers states and territories of the US. It extends to the county level with an additional four digits, so every county in the US has a unique six-digit identifier, where the first two digits represent the state.</p>
<p>We will be using Kieran Healy&rsquo;s <code>socviz</code> package which among other things contains <code>county_map</code> and <code>county_data</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># America’s choropleths; use county_map that has all polygons </span>
<span style="color:#75715e"># and county data with demographics/election data from socviz datafile</span>
<span style="color:#75715e"># The id field is the FIPS code for the county</span>
county_map <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">sample_n</span>(<span style="color:#ae81ff">5</span>)
</code></pre></div><pre><code>##      long     lat  order  hole piece            group    id
## 1   57111 -244795 110862 FALSE     1 0500000US31103.1 31103
## 2 1423522 -669990  66797 FALSE     1 0500000US21129.1 21129
## 3 1259604 -680561  63644 FALSE     1 0500000US21029.1 21029
## 4  275597 -267007 110332 FALSE     1 0500000US31051.1 31051
## 5   27728 -137268 148481 FALSE     1 0500000US46085.1 46085
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">county_data <span style="color:#f92672">%&gt;%</span>
    <span style="color:#a6e22e">sample_n</span>(<span style="color:#ae81ff">5</span>)
</code></pre></div><pre><code>##      id           name state census_region      pop_dens   pop_dens4
## 1 46115   Spink County    SD       Midwest [    0,   10) [  0,   17)
## 2 55085  Oneida County    WI       Midwest [   10,   50) [ 17,   45)
## 3 21235 Whitley County    KY         South [   50,  100) [ 45,  118)
## 4 05029  Conway County    AR         South [   10,   50) [ 17,   45)
## 5 26137  Otsego County    MI       Midwest [   10,   50) [ 45,  118)
##     pop_dens6   pct_black   pop female white black travel_time land_area
## 1 [  0,    9) [ 0.0, 2.0)  6598   49.6  96.7   0.7        15.8      1504
## 2 [ 25,   45) [ 0.0, 2.0) 35563   50.1  96.6   0.5        19.2      1113
## 3 [ 45,   82) [ 0.0, 2.0) 35503   51.0  97.1   0.8        19.7       438
## 4 [ 25,   45) [10.0,15.0) 21083   51.0  85.1  11.4        22.2       552
## 5 [ 45,   82) [ 0.0, 2.0) 24158   50.8  96.4   0.5        20.5       515
##   hh_income su_gun4 su_gun6  fips votes_dem_2016 votes_gop_2016
## 1     48911 [ 0, 5) [ 0, 4) 46115            919           1854
## 2     45759 [ 8,11) [ 8,10) 55085           8103          11677
## 3     29769 [11,54] [12,54] 21235           2067          11312
## 4     35225 [11,54] [10,12)  5029           2655           4844
## 5     47584 [ 8,11) [ 8,10) 26137           3556           8266
##   total_votes_2016 per_dem_2016 per_gop_2016 diff_2016 per_dem_2012
## 1             2951        0.311        0.628       935        0.427
## 2            20837        0.389        0.560      3574        0.484
## 3            13765        0.150        0.822      9245        0.205
## 4             7837        0.339        0.618      2189        0.389
## 5            12529        0.284        0.660      4710        0.396
##   per_gop_2012 diff_2012 winner partywinner16 winner12 partywinner12
## 1        0.549       370  Trump    Republican   Romney    Republican
## 2        0.505       466  Trump    Republican   Romney    Republican
## 3        0.783      7549  Trump    Republican   Romney    Republican
## 4        0.584      1508  Trump    Republican   Romney    Republican
## 5        0.592      2327  Trump    Republican   Romney    Republican
##   flipped
## 1      No
## 2      No
## 3      No
## 4      No
## 5      No
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">glimpse</span>(county_data)
</code></pre></div><pre><code>## Rows: 3,195
## Columns: 32
## $ id               &lt;chr&gt; &quot;0&quot;, &quot;01000&quot;, &quot;01001&quot;, &quot;01003&quot;, &quot;01005&quot;, &quot;0100…
## $ name             &lt;chr&gt; NA, &quot;1&quot;, &quot;Autauga County&quot;, &quot;Baldwin County&quot;, &quot;…
## $ state            &lt;fct&gt; NA, AL, AL, AL, AL, AL, AL, AL, AL, AL, AL, AL…
## $ census_region    &lt;fct&gt; NA, South, South, South, South, South, South, …
## $ pop_dens         &lt;fct&gt; &quot;[   50,  100)&quot;, &quot;[   50,  100)&quot;, &quot;[   50,  10…
## $ pop_dens4        &lt;fct&gt; &quot;[ 45,  118)&quot;, &quot;[ 45,  118)&quot;, &quot;[ 45,  118)&quot;, &quot;…
## $ pop_dens6        &lt;fct&gt; &quot;[ 82,  215)&quot;, &quot;[ 82,  215)&quot;, &quot;[ 82,  215)&quot;, &quot;…
## $ pct_black        &lt;fct&gt; &quot;[10.0,15.0)&quot;, &quot;[25.0,50.0)&quot;, &quot;[15.0,25.0)&quot;, &quot;…
## $ pop              &lt;int&gt; 318857056, 4849377, 55395, 200111, 26887, 2250…
## $ female           &lt;dbl&gt; 50.8, 51.5, 51.5, 51.2, 46.5, 46.0, 50.6, 45.2…
## $ white            &lt;dbl&gt; 77.7, 69.8, 78.1, 87.3, 50.2, 76.3, 96.0, 27.2…
## $ black            &lt;dbl&gt; 13.2, 26.6, 18.4, 9.5, 47.6, 22.1, 1.8, 69.9, …
## $ travel_time      &lt;dbl&gt; 25.5, 24.2, 26.2, 25.9, 24.6, 27.6, 33.9, 26.9…
## $ land_area        &lt;dbl&gt; 3531905, 50645, 594, 1590, 885, 623, 645, 623,…
## $ hh_income        &lt;int&gt; 53046, 43253, 53682, 50221, 32911, 36447, 4414…
## $ su_gun4          &lt;fct&gt; NA, NA, &quot;[11,54]&quot;, &quot;[11,54]&quot;, &quot;[ 5, 8)&quot;, &quot;[11,…
## $ su_gun6          &lt;fct&gt; NA, NA, &quot;[10,12)&quot;, &quot;[10,12)&quot;, &quot;[ 7, 8)&quot;, &quot;[10,…
## $ fips             &lt;dbl&gt; 0, 1000, 1001, 1003, 1005, 1007, 1009, 1011, 1…
## $ votes_dem_2016   &lt;int&gt; NA, NA, 5908, 18409, 4848, 1874, 2150, 3530, 3…
## $ votes_gop_2016   &lt;int&gt; NA, NA, 18110, 72780, 5431, 6733, 22808, 1139,…
## $ total_votes_2016 &lt;int&gt; NA, NA, 24661, 94090, 10390, 8748, 25384, 4701…
## $ per_dem_2016     &lt;dbl&gt; NA, NA, 0.2396, 0.1957, 0.4666, 0.2142, 0.0847…
## $ per_gop_2016     &lt;dbl&gt; NA, NA, 0.734, 0.774, 0.523, 0.770, 0.899, 0.2…
## $ diff_2016        &lt;int&gt; NA, NA, 12202, 54371, 583, 4859, 20658, 2391, …
## $ per_dem_2012     &lt;dbl&gt; NA, NA, 0.266, 0.216, 0.513, 0.262, 0.123, 0.7…
## $ per_gop_2012     &lt;dbl&gt; NA, NA, 0.726, 0.774, 0.483, 0.731, 0.865, 0.2…
## $ diff_2012        &lt;int&gt; NA, NA, 11012, 47443, 334, 3931, 17780, 2808, …
## $ winner           &lt;chr&gt; NA, NA, &quot;Trump&quot;, &quot;Trump&quot;, &quot;Trump&quot;, &quot;Trump&quot;, &quot;T…
## $ partywinner16    &lt;chr&gt; NA, NA, &quot;Republican&quot;, &quot;Republican&quot;, &quot;Republica…
## $ winner12         &lt;chr&gt; NA, NA, &quot;Romney&quot;, &quot;Romney&quot;, &quot;Obama&quot;, &quot;Romney&quot;,…
## $ partywinner12    &lt;chr&gt; NA, NA, &quot;Republican&quot;, &quot;Republican&quot;, &quot;Democrat&quot;…
## $ flipped          &lt;chr&gt; NA, NA, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;…
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># we have data on 3195 FIPS....</span>

<span style="color:#a6e22e">glimpse</span>(county_map)
</code></pre></div><pre><code>## Rows: 191,382
## Columns: 7
## $ long  &lt;dbl&gt; 1225889, 1235324, 1244873, 1244129, 1272010, 1276797, 127…
## $ lat   &lt;dbl&gt; -1275020, -1274008, -1272331, -1267515, -1262889, -129551…
## $ order &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17…
## $ hole  &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, F…
## $ piece &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ group &lt;fct&gt; 0500000US01001.1, 0500000US01001.1, 0500000US01001.1, 050…
## $ id    &lt;chr&gt; &quot;01001&quot;, &quot;01001&quot;, &quot;01001&quot;, &quot;01001&quot;, &quot;01001&quot;, &quot;01001&quot;, &quot;01…
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># ... but to create a map, we translate these 3195 counties to 191,382 polygons!</span>
</code></pre></div><h2 id="joing-the-files">Joing the files</h2>
<p>We have three files</p>
<ol>
<li><code>nyt_mask_survey</code>, our NYT survey data,</li>
<li><code>county_map</code> that has all polygons that define a county</li>
<li><code>county_data</code> with demographics/election data.</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">county_full <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">left_join</span>(county_map, county_data, by <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;id&#34;</span>)

county_masks_full <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">left_join</span>(county_full, nyt_mask_survey, 
                                by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;countyfp&#34;</span>))
</code></pre></div><h2 id="building-our-choropleth-plot">Building our choropleth plot</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ggplot</span>(data <span style="color:#f92672">=</span> county_masks_full,
            mapping <span style="color:#f92672">=</span> <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> long, y <span style="color:#f92672">=</span> lat,
                          fill <span style="color:#f92672">=</span> delta, 
                          group <span style="color:#f92672">=</span> group))

p1 <span style="color:#f92672">&lt;-</span> p <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">geom_polygon</span>(color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gray90&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.05</span>) <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">coord_equal</span>()



p2 <span style="color:#f92672">&lt;-</span> p1 <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">scale_fill_gradient</span>(low <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;#ffffcc&#39;</span>, high<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;#006837&#39;</span>)

p3 <span style="color:#f92672">&lt;-</span> p1 <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">scale_fill_gradient2</span>()

<span style="color:#75715e"># get different colours from https://colorbrewer2.org/</span>
<span style="color:#75715e"># the one shown here is https://colorbrewer2.org/#type=diverging&amp;scheme=BrBG&amp;n=6</span>
p4 <span style="color:#f92672">&lt;-</span> p1 <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">scale_fill_gradientn</span>(colours <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;#8c510a&#39;</span>,<span style="color:#e6db74">&#39;#d8b365&#39;</span>,<span style="color:#e6db74">&#39;#f6e8c3&#39;</span>,<span style="color:#e6db74">&#39;#c7eae5&#39;</span>,<span style="color:#e6db74">&#39;#5ab4ac&#39;</span>,<span style="color:#e6db74">&#39;#01665e&#39;</span>))

p1
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p2
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p3
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p4
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p4 <span style="color:#f92672">+</span> <span style="color:#a6e22e">labs</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Mask acceptance, (Mostly Yes - Mostly No)&#34;</span>, 
          caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;“Estimates from The New York Times, based on roughly 250,000 interviews \nconducted by Dynata from July 2 to July 14, 2020”&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(fill <span style="color:#f92672">=</span> <span style="color:#a6e22e">guide_legend</span>(nrow <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)) <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">theme_map</span>() <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">theme</span>(legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>)
</code></pre></div><p><!-- raw HTML omitted --></p>
<h2 id="checking-for-relationships">Checking for relationships</h2>
<p>Does mask use acceptance have any relation with some demographics? Let us explor the relationship between country household income, population, and % who voted republican in 2016</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">county_masks_full <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(hh_income, pop, per_gop_2016, delta) <span style="color:#f92672">%&gt;%</span> 
  GGally<span style="color:#f92672">::</span><span style="color:#a6e22e">ggpairs</span>()<span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>()
</code></pre></div><p><!-- raw HTML omitted --></p>

                        </div>
                    </section>
            <!-- Disqus Inject -->
                
            </div>
            
        <!-- Footer -->
            
                <!-- Footer -->
    <footer id="footer">
        <div class="inner">
            <ul class="icons">
                
                    <li><a href="https://www.twitter.com" class="icon alt fa-twitter" target="_blank"><span class="label">Twitter</span></a></li>
                
                    <li><a href="https://www.facebook.com" class="icon alt fa-facebook" target="_blank"><span class="label">Facebook</span></a></li>
                
                    <li><a href="https://www.instagram.com" class="icon alt fa-instagram" target="_blank"><span class="label">Instagram</span></a></li>
                
                    <li><a href="https://www.github.com" class="icon alt fa-github" target="_blank"><span class="label">GitHub</span></a></li>
                
                    <li><a href="https://www.linkedin.com" class="icon alt fa-linkedin" target="_blank"><span class="label">LinkedIn</span></a></li>
                
            </ul>
            <ul class="copyright">
                <li>&copy; London Business School</li>
                
                <li>Design:  <a href="https://www.html5up.net">HTML5 UP</a></li>
                
            </ul>
        </div>
    </footer>

            
        </div>

    <!-- Scripts -->
        <!-- Scripts -->
    <!-- jQuery -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>

    

    <!-- Main JS -->
    <script src="/js/main.js"></script>

    

    

    </body>
</html>
